import os
from pathlib import Path
from .static.run_cppcheck import main as cppcheck_main
from .static.run_semgrep import main as semgrep_main
from .static.run_flawfinder import main as flawfinder_main
from .static.run_rats import main as rats_main
from .llm.llm_evaluate import main as llm_main

#Create output directories
BASE_DIR = Path(__file__).resolve().parent
for folder in [
    "output",
    os.path.join("output", "semgrep"),
    os.path.join("output", "cppcheck"),
    os.path.join("output", "flawfinder"),
    os.path.join("output", "rats"),
    os.path.join("output", "llm")
]:
    os.makedirs(os.path.join(BASE_DIR, folder), exist_ok=True)

def main():
    """
    Run static analysis tools and LLM for each language 
    """
    semgrep_main()
    cppcheck_main()
    flawfinder_main()
    #rats_main() #Not supported on Windows
    llm_main()

if __name__ == '__main__':
    main()